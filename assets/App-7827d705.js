import{r as B,u as q,M as et,s as is,j as k,F as H,a as F,C as rs,S as Cn,U as os,b as en,B as Bn,R as ct,c as Mn,V as O,d as Et,P as En,L as ut,T as Ut,e as cs,f as mt,g as lt,D as ls,h as nn,i as Nn,k as as,l as us,m as sn,n as fs,o as Wt,p as xe,q as ps,E as we,t as be,G as ue,v as kn,w as We,x as ds,y as hs,z as ms,A as Bt,H as ys,I as gs,O as xs}from"./index-4cc7fa03.js";import"//cdn.skypack.dev/three@0.130.1/build/three.module.js";function ws(){const t=B.useRef(),e=q(i=>i.wiringStep);let{currentStepObject:n,setCurrentSVG:s}=B.useContext(et);return B.useEffect(()=>{e&&document.getElementById("myEmbed").addEventListener("load",function(){s(is(document.getElementById("myEmbed")))})},[e]),k(H,{children:e?k("div",{id:"svgContainer",style:{position:"absolute",width:"100%",height:"100%",bottom:"0px",left:"0px",padding:"10px"},children:k("embed",{style:{width:"100%",height:"100%",backgroundColor:"#e9e9e9"},ref:t,type:"image/svg+xml",src:`./${n.name}.svg`,id:"myEmbed"})}):null})}function bs(){let{setStepPosition:t,stepCount:e}=B.useContext(et);const n=()=>{e++,t(e)},s=()=>{e--,t(e)};return F(H,{children:[e>=1?k("button",{onClick:s,className:"btn",id:"nextStep",children:" ❮ Previous Step  "}):null,k("button",{onClick:n,className:"btn",id:"nextStep",children:"Next Step ❯ "})]})}function As(){const{setModelInOut:t,selectedParts:e}=B.useContext(et),[n,s]=B.useState(!1),i=q(r=>r.wiringStep);return k(H,{children:i?null:k("button",{onClick:()=>{n==!1?(document.getElementById("partsOut").innerHTML="Assemble",s(!0),t(n)):n==!0&&(document.getElementById("partsOut").innerHTML="Explode",s(!1),t(n))},className:"btn",id:"partsOut",children:"Explode"})})}class vs{constructor(e,n={}){this.enabled=!0;const s=n.defaultThickness!==void 0?n.defaultThickness:.003,i=new rs().fromArray(n.defaultColor!==void 0?n.defaultColor:[0,0,0]),l=n.defaultAlpha!==void 0?n.defaultAlpha:1,r=n.defaultKeepAlive!==void 0?n.defaultKeepAlive:!1,c={},o=60,f={},u={},p={outlineThickness:{value:s},outlineColor:{value:i},outlineAlpha:{value:l}},a=["#include <common>","#include <uv_pars_vertex>","#include <displacementmap_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","uniform float outlineThickness;","vec4 calculateOutline( vec4 pos, vec3 normal, vec4 skinned ) {","	float thickness = outlineThickness;","	const float ratio = 1.0;","	vec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + normal, 1.0 );","	vec4 norm = normalize( pos - pos2 );","	return pos + norm * thickness * pos.w * ratio;","}","void main() {","	#include <uv_vertex>","	#include <beginnormal_vertex>","	#include <morphnormal_vertex>","	#include <skinbase_vertex>","	#include <skinnormal_vertex>","	#include <begin_vertex>","	#include <morphtarget_vertex>","	#include <skinning_vertex>","	#include <displacementmap_vertex>","	#include <project_vertex>","	vec3 outlineNormal = - objectNormal;","	gl_Position = calculateOutline( gl_Position, outlineNormal, vec4( transformed, 1.0 ) );","	#include <logdepthbuf_vertex>","	#include <clipping_planes_vertex>","	#include <fog_vertex>","}"].join(`
`),d=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","uniform vec3 outlineColor;","uniform float outlineAlpha;","void main() {","	#include <clipping_planes_fragment>","	#include <logdepthbuf_fragment>","	gl_FragColor = vec4( outlineColor, outlineAlpha );","	#include <tonemapping_fragment>","	#include <encodings_fragment>","	#include <fog_fragment>","	#include <premultiplied_alpha_fragment>","}"].join(`
`);function P(){return new Cn({type:"OutlineEffect",uniforms:os.merge([en.fog,en.displacementmap,p]),vertexShader:a,fragmentShader:d,side:Bn})}function T(h){let m=c[h.uuid];return m===void 0&&(m={material:P(),used:!0,keepAlive:r,count:0},c[h.uuid]=m),m.used=!0,m.material}function w(h){const m=T(h);return f[m.uuid]=h,S(m,h),m}function g(h){const m=h.geometry;let A=!1;return h.geometry!==void 0&&(m.isBufferGeometry?A=m.attributes.normal!==void 0:A=!0),h.isMesh===!0&&h.material!==void 0&&A===!0}function y(h){if(g(h)!==!1){if(Array.isArray(h.material))for(let m=0,A=h.material.length;m<A;m++)h.material[m]=w(h.material[m]);else h.material=w(h.material);u[h.uuid]=h.onBeforeRender,h.onBeforeRender=x}}function b(h){if(g(h)!==!1){if(Array.isArray(h.material))for(let m=0,A=h.material.length;m<A;m++)h.material[m]=f[h.material[m].uuid];else h.material=f[h.material.uuid];h.onBeforeRender=u[h.uuid]}}function x(h,m,A,M,C){const E=f[C.uuid];E!==void 0&&v(C,E)}function v(h,m){const A=m.userData.outlineParameters;h.uniforms.outlineAlpha.value=m.opacity,A!==void 0&&(A.thickness!==void 0&&(h.uniforms.outlineThickness.value=A.thickness),A.color!==void 0&&h.uniforms.outlineColor.value.fromArray(A.color),A.alpha!==void 0&&(h.uniforms.outlineAlpha.value=A.alpha)),m.displacementMap&&(h.uniforms.displacementMap.value=m.displacementMap,h.uniforms.displacementScale.value=m.displacementScale,h.uniforms.displacementBias.value=m.displacementBias)}function S(h,m){if(h.name==="invisible")return;const A=m.userData.outlineParameters;h.fog=m.fog,h.toneMapped=m.toneMapped,h.premultipliedAlpha=m.premultipliedAlpha,h.displacementMap=m.displacementMap,A!==void 0?(m.visible===!1?h.visible=!1:h.visible=A.visible!==void 0?A.visible:!0,h.transparent=A.alpha!==void 0&&A.alpha<1?!0:m.transparent,A.keepAlive!==void 0&&(c[m.uuid].keepAlive=A.keepAlive)):(h.transparent=m.transparent,h.visible=m.visible),(m.wireframe===!0||m.depthTest===!1)&&(h.visible=!1),m.clippingPlanes&&(h.clipping=!0,h.clippingPlanes=m.clippingPlanes,h.clipIntersection=m.clipIntersection,h.clipShadows=m.clipShadows),h.version=m.version}function _(){let h;h=Object.keys(f);for(let m=0,A=h.length;m<A;m++)f[h[m]]=void 0;h=Object.keys(u);for(let m=0,A=h.length;m<A;m++)u[h[m]]=void 0;h=Object.keys(c);for(let m=0,A=h.length;m<A;m++){const M=h[m];c[M].used===!1?(c[M].count++,c[M].keepAlive===!1&&c[M].count>o&&delete c[M]):(c[M].used=!1,c[M].count=0)}}this.render=function(h,m){if(this.enabled===!1){e.render(h,m);return}const A=e.autoClear;e.autoClear=this.autoClear,e.render(h,m),e.autoClear=A,this.renderOutline(h,m)},this.renderOutline=function(h,m){const A=e.autoClear,M=h.matrixWorldAutoUpdate,C=h.background,E=e.shadowMap.enabled;h.matrixWorldAutoUpdate=!1,h.background=null,e.autoClear=!1,e.shadowMap.enabled=!1,h.traverse(y),e.render(h,m),h.traverse(b),_(),h.matrixWorldAutoUpdate=M,h.background=C,e.autoClear=A,e.shadowMap.enabled=E},this.autoClear=e.autoClear,this.domElement=e.domElement,this.shadowMap=e.shadowMap,this.clear=function(h,m,A){e.clear(h,m,A)},this.getPixelRatio=function(){return e.getPixelRatio()},this.setPixelRatio=function(h){e.setPixelRatio(h)},this.getSize=function(h){return e.getSize(h)},this.setSize=function(h,m,A){e.setSize(h,m,A)},this.setViewport=function(h,m,A,M){e.setViewport(h,m,A,M)},this.setScissor=function(h,m,A,M){e.setScissor(h,m,A,M)},this.setScissorTest=function(h){e.setScissorTest(h)},this.setRenderTarget=function(h){e.setRenderTarget(h)}}}const Ps=B.createContext(null);function Ts(t){let{children:e,enabled:n=!0}=t;const[s,i]=B.useState([]),l=B.useMemo(()=>({selected:s,select:i,enabled:n}),[s,i,n]);return ct.createElement(Ps.Provider,{value:l},e)}const Ln=0,Ss=1,_s=2,rn=2,Ae=1.25,on=1,It=6*4+4+4,me=65535,Cs=Math.pow(2,-24),ve=Symbol("SKIP_GENERATION");function Bs(t){return t.index?t.index.count:t.attributes.position.count}function Nt(t){return Bs(t)/3}function Ms(t,e=ArrayBuffer){return t>65535?new Uint32Array(new e(4*t)):new Uint16Array(new e(2*t))}function Es(t,e){if(!t.index){const n=t.attributes.position.count,s=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=Ms(n,s);t.setIndex(new Mn(i,1));for(let l=0;l<n;l++)i[l]=l}}function On(t){const e=Nt(t),n=t.drawRange,s=n.start/3,i=(n.start+n.count)/3,l=Math.max(0,s),r=Math.min(e,i)-l;return[{offset:Math.floor(l),count:Math.floor(r)}]}function zn(t){if(!t.groups||!t.groups.length)return On(t);const e=[],n=new Set,s=t.drawRange,i=s.start/3,l=(s.start+s.count)/3;for(const c of t.groups){const o=c.start/3,f=(c.start+c.count)/3;n.add(Math.max(i,o)),n.add(Math.min(l,f))}const r=Array.from(n.values()).sort((c,o)=>c-o);for(let c=0;c<r.length-1;c++){const o=r[c],f=r[c+1];e.push({offset:Math.floor(o),count:Math.floor(f-o)})}return e}function Ns(t){if(t.groups.length===0)return!1;const e=Nt(t),n=zn(t).sort((l,r)=>l.offset-r.offset),s=n[n.length-1];s.count=Math.min(e-s.offset,s.count);let i=0;return n.forEach(({count:l})=>i+=l),e!==i}function Pe(t,e,n,s,i){let l=1/0,r=1/0,c=1/0,o=-1/0,f=-1/0,u=-1/0,p=1/0,a=1/0,d=1/0,P=-1/0,T=-1/0,w=-1/0;for(let g=e*6,y=(e+n)*6;g<y;g+=6){const b=t[g+0],x=t[g+1],v=b-x,S=b+x;v<l&&(l=v),S>o&&(o=S),b<p&&(p=b),b>P&&(P=b);const _=t[g+2],h=t[g+3],m=_-h,A=_+h;m<r&&(r=m),A>f&&(f=A),_<a&&(a=_),_>T&&(T=_);const M=t[g+4],C=t[g+5],E=M-C,N=M+C;E<c&&(c=E),N>u&&(u=N),M<d&&(d=M),M>w&&(w=M)}s[0]=l,s[1]=r,s[2]=c,s[3]=o,s[4]=f,s[5]=u,i[0]=p,i[1]=a,i[2]=d,i[3]=P,i[4]=T,i[5]=w}function ks(t,e=null,n=null,s=null){const i=t.attributes.position,l=t.index?t.index.array:null,r=Nt(t),c=i.normalized;let o;e===null?(o=new Float32Array(r*6*4),n=0,s=r):(o=e,n=n||0,s=s||r);const f=i.array,u=i.offset||0;let p=3;i.isInterleavedBufferAttribute&&(p=i.data.stride);const a=["getX","getY","getZ"];for(let d=n;d<n+s;d++){const P=d*3,T=d*6;let w=P+0,g=P+1,y=P+2;l&&(w=l[w],g=l[g],y=l[y]),c||(w=w*p+u,g=g*p+u,y=y*p+u);for(let b=0;b<3;b++){let x,v,S;c?(x=i[a[b]](w),v=i[a[b]](g),S=i[a[b]](y)):(x=f[w+b],v=f[g+b],S=f[y+b]);let _=x;v<_&&(_=v),S<_&&(_=S);let h=x;v>h&&(h=v),S>h&&(h=S);const m=(h-_)/2,A=b*2;o[T+A+0]=_+m,o[T+A+1]=m+(Math.abs(_)+m)*Cs}}return o}function I(t,e,n){return n.min.x=e[t],n.min.y=e[t+1],n.min.z=e[t+2],n.max.x=e[t+3],n.max.y=e[t+4],n.max.z=e[t+5],n}function cn(t){let e=-1,n=-1/0;for(let s=0;s<3;s++){const i=t[s+3]-t[s];i>n&&(n=i,e=s)}return e}function ln(t,e){e.set(t)}function an(t,e,n){let s,i;for(let l=0;l<3;l++){const r=l+3;s=t[l],i=e[l],n[l]=s<i?s:i,s=t[r],i=e[r],n[r]=s>i?s:i}}function Kt(t,e,n){for(let s=0;s<3;s++){const i=e[t+2*s],l=e[t+2*s+1],r=i-l,c=i+l;r<n[s]&&(n[s]=r),c>n[s+3]&&(n[s+3]=c)}}function Lt(t){const e=t[3]-t[0],n=t[4]-t[1],s=t[5]-t[2];return 2*(e*n+n*s+s*e)}const at=32,Ls=(t,e)=>t.candidate-e.candidate,pt=new Array(at).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Xt=new Float32Array(6);function Os(t,e,n,s,i,l){let r=-1,c=0;if(l===Ln)r=cn(e),r!==-1&&(c=(e[r]+e[r+3])/2);else if(l===Ss)r=cn(t),r!==-1&&(c=zs(n,s,i,r));else if(l===_s){const o=Lt(t);let f=Ae*i;const u=s*6,p=(s+i)*6;for(let a=0;a<3;a++){const d=e[a],w=(e[a+3]-d)/at;if(i<at/4){const g=[...pt];g.length=i;let y=0;for(let x=u;x<p;x+=6,y++){const v=g[y];v.candidate=n[x+2*a],v.count=0;const{bounds:S,leftCacheBounds:_,rightCacheBounds:h}=v;for(let m=0;m<3;m++)h[m]=1/0,h[m+3]=-1/0,_[m]=1/0,_[m+3]=-1/0,S[m]=1/0,S[m+3]=-1/0;Kt(x,n,S)}g.sort(Ls);let b=i;for(let x=0;x<b;x++){const v=g[x];for(;x+1<b&&g[x+1].candidate===v.candidate;)g.splice(x+1,1),b--}for(let x=u;x<p;x+=6){const v=n[x+2*a];for(let S=0;S<b;S++){const _=g[S];v>=_.candidate?Kt(x,n,_.rightCacheBounds):(Kt(x,n,_.leftCacheBounds),_.count++)}}for(let x=0;x<b;x++){const v=g[x],S=v.count,_=i-v.count,h=v.leftCacheBounds,m=v.rightCacheBounds;let A=0;S!==0&&(A=Lt(h)/o);let M=0;_!==0&&(M=Lt(m)/o);const C=on+Ae*(A*S+M*_);C<f&&(r=a,f=C,c=v.candidate)}}else{for(let b=0;b<at;b++){const x=pt[b];x.count=0,x.candidate=d+w+b*w;const v=x.bounds;for(let S=0;S<3;S++)v[S]=1/0,v[S+3]=-1/0}for(let b=u;b<p;b+=6){let S=~~((n[b+2*a]-d)/w);S>=at&&(S=at-1);const _=pt[S];_.count++,Kt(b,n,_.bounds)}const g=pt[at-1];ln(g.bounds,g.rightCacheBounds);for(let b=at-2;b>=0;b--){const x=pt[b],v=pt[b+1];an(x.bounds,v.rightCacheBounds,x.rightCacheBounds)}let y=0;for(let b=0;b<at-1;b++){const x=pt[b],v=x.count,S=x.bounds,h=pt[b+1].rightCacheBounds;v!==0&&(y===0?ln(S,Xt):an(S,Xt,Xt)),y+=v;let m=0,A=0;y!==0&&(m=Lt(Xt)/o);const M=i-y;M!==0&&(A=Lt(h)/o);const C=on+Ae*(m*y+A*M);C<f&&(r=a,f=C,c=x.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${l} used.`);return{axis:r,pos:c}}function zs(t,e,n,s){let i=0;for(let l=e,r=e+n;l<r;l++)i+=t[l*6+s*2];return i/n}class Te{constructor(){this.boundingData=new Float32Array(6)}}function Rs(t,e,n,s,i,l){let r=s,c=s+i-1;const o=l.pos,f=l.axis*2;for(;;){for(;r<=c&&n[r*6+f]<o;)r++;for(;r<=c&&n[c*6+f]>=o;)c--;if(r<c){for(let u=0;u<3;u++){let p=e[r*3+u];e[r*3+u]=e[c*3+u],e[c*3+u]=p}for(let u=0;u<6;u++){let p=n[r*6+u];n[r*6+u]=n[c*6+u],n[c*6+u]=p}r++,c--}else return r}}function Vs(t,e,n,s,i,l){let r=s,c=s+i-1;const o=l.pos,f=l.axis*2;for(;;){for(;r<=c&&n[r*6+f]<o;)r++;for(;r<=c&&n[c*6+f]>=o;)c--;if(r<c){let u=t[r];t[r]=t[c],t[c]=u;for(let p=0;p<6;p++){let a=n[r*6+p];n[r*6+p]=n[c*6+p],n[c*6+p]=a}r++,c--}else return r}}function X(t,e){return e[t+15]===65535}function Y(t,e){return e[t+6]}function G(t,e){return e[t+14]}function Q(t){return t+8}function J(t,e){return e[t+6]}function Rn(t,e){return e[t+7]}let Vn,Dt,ae,Fn;const Fs=Math.pow(2,32);function Re(t){return"count"in t?1:1+Re(t.left)+Re(t.right)}function Us(t,e,n){return Vn=new Float32Array(n),Dt=new Uint32Array(n),ae=new Uint16Array(n),Fn=new Uint8Array(n),Ve(t,e)}function Ve(t,e){const n=t/4,s=t/2,i="count"in e,l=e.boundingData;for(let r=0;r<6;r++)Vn[n+r]=l[r];if(i)if(e.buffer){const r=e.buffer;Fn.set(new Uint8Array(r),t);for(let c=t,o=t+r.byteLength;c<o;c+=It){const f=c/2;X(f,ae)||(Dt[c/4+6]+=n)}return t+r.byteLength}else{const r=e.offset,c=e.count;return Dt[n+6]=r,ae[s+14]=c,ae[s+15]=me,t+It}else{const r=e.left,c=e.right,o=e.splitAxis;let f;if(f=Ve(t+It,r),f/4>Fs)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return Dt[n+6]=f/4,f=Ve(f,c),Dt[n+7]=o,f}}function Ds(t,e){const n=(t.index?t.index.count:t.attributes.position.count)/3,s=n>2**16,i=s?4:2,l=e?new SharedArrayBuffer(n*i):new ArrayBuffer(n*i),r=s?new Uint32Array(l):new Uint16Array(l);for(let c=0,o=r.length;c<o;c++)r[c]=c;return r}function Is(t,e,n,s,i){const{maxDepth:l,verbose:r,maxLeafTris:c,strategy:o,onProgress:f,indirect:u}=i,p=t._indirectBuffer,a=t.geometry,d=a.index?a.index.array:null,P=u?Vs:Rs,T=Nt(a),w=new Float32Array(6);let g=!1;const y=new Te;return Pe(e,n,s,y.boundingData,w),x(y,n,s,w),y;function b(v){f&&f(v/T)}function x(v,S,_,h=null,m=0){if(!g&&m>=l&&(g=!0,r&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(a))),_<=c||m>=l)return b(S+_),v.offset=S,v.count=_,v;const A=Os(v.boundingData,h,e,S,_,o);if(A.axis===-1)return b(S+_),v.offset=S,v.count=_,v;const M=P(p,d,e,S,_,A);if(M===S||M===S+_)b(S+_),v.offset=S,v.count=_;else{v.splitAxis=A.axis;const C=new Te,E=S,N=M-S;v.left=C,Pe(e,E,N,C.boundingData,w),x(C,E,N,w,m+1);const z=new Te,V=M,Z=_-N;v.right=z,Pe(e,V,Z,z.boundingData,w),x(z,V,Z,w,m+1)}return v}}function js(t,e){const n=t.geometry;e.indirect&&(t._indirectBuffer=Ds(n,e.useSharedArrayBuffer),Ns(n)&&!e.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),t._indirectBuffer||Es(n,e);const s=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=ks(n),l=e.indirect?On(n):zn(n);t._roots=l.map(r=>{const c=Is(t,i,r.offset,r.count,e),o=Re(c),f=new s(It*o);return Us(0,c,f),f})}class ft{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,n){let s=1/0,i=-1/0;for(let l=0,r=e.length;l<r;l++){const o=e[l][n];s=o<s?o:s,i=o>i?o:i}this.min=s,this.max=i}setFromPoints(e,n){let s=1/0,i=-1/0;for(let l=0,r=n.length;l<r;l++){const c=n[l],o=e.dot(c);s=o<s?o:s,i=o>i?o:i}this.min=s,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}}ft.prototype.setFromBox=function(){const t=new O;return function(n,s){const i=s.min,l=s.max;let r=1/0,c=-1/0;for(let o=0;o<=1;o++)for(let f=0;f<=1;f++)for(let u=0;u<=1;u++){t.x=i.x*o+l.x*(1-o),t.y=i.y*f+l.y*(1-f),t.z=i.z*u+l.z*(1-u);const p=n.dot(t);r=Math.min(p,r),c=Math.max(p,c)}this.min=r,this.max=c}}();const $s=function(){const t=new O,e=new O,n=new O;return function(i,l,r){const c=i.start,o=t,f=l.start,u=e;n.subVectors(c,f),t.subVectors(i.end,i.start),e.subVectors(l.end,l.start);const p=n.dot(u),a=u.dot(o),d=u.dot(u),P=n.dot(o),w=o.dot(o)*d-a*a;let g,y;w!==0?g=(p*a-P*d)/w:g=0,y=(p+g*a)/d,r.x=g,r.y=y}}(),Ke=function(){const t=new Et,e=new O,n=new O;return function(i,l,r,c){$s(i,l,t);let o=t.x,f=t.y;if(o>=0&&o<=1&&f>=0&&f<=1){i.at(o,r),l.at(f,c);return}else if(o>=0&&o<=1){f<0?l.at(0,c):l.at(1,c),i.closestPointToPoint(c,!0,r);return}else if(f>=0&&f<=1){o<0?i.at(0,r):i.at(1,r),l.closestPointToPoint(r,!0,c);return}else{let u;o<0?u=i.start:u=i.end;let p;f<0?p=l.start:p=l.end;const a=e,d=n;if(i.closestPointToPoint(p,!0,e),l.closestPointToPoint(u,!0,n),a.distanceToSquared(p)<=d.distanceToSquared(u)){r.copy(a),c.copy(p);return}else{r.copy(u),c.copy(d);return}}}}(),qs=function(){const t=new O,e=new O,n=new En,s=new ut;return function(l,r){const{radius:c,center:o}=l,{a:f,b:u,c:p}=r;if(s.start=f,s.end=u,s.closestPointToPoint(o,!0,t).distanceTo(o)<=c||(s.start=f,s.end=p,s.closestPointToPoint(o,!0,t).distanceTo(o)<=c)||(s.start=u,s.end=p,s.closestPointToPoint(o,!0,t).distanceTo(o)<=c))return!0;const T=r.getPlane(n);if(Math.abs(T.distanceToPoint(o))<=c){const g=T.projectPoint(o,e);if(r.containsPoint(g))return!0}return!1}}(),Hs=1e-15;function Se(t){return Math.abs(t)<Hs}class st extends Ut{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new O),this.satBounds=new Array(4).fill().map(()=>new ft),this.points=[this.a,this.b,this.c],this.sphere=new cs,this.plane=new En,this.needsUpdate=!0}intersectsSphere(e){return qs(e,this)}update(){const e=this.a,n=this.b,s=this.c,i=this.points,l=this.satAxes,r=this.satBounds,c=l[0],o=r[0];this.getNormal(c),o.setFromPoints(c,i);const f=l[1],u=r[1];f.subVectors(e,n),u.setFromPoints(f,i);const p=l[2],a=r[2];p.subVectors(n,s),a.setFromPoints(p,i);const d=l[3],P=r[3];d.subVectors(s,e),P.setFromPoints(d,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(c,e),this.needsUpdate=!1}}st.prototype.closestPointToSegment=function(){const t=new O,e=new O,n=new ut;return function(i,l=null,r=null){const{start:c,end:o}=i,f=this.points;let u,p=1/0;for(let a=0;a<3;a++){const d=(a+1)%3;n.start.copy(f[a]),n.end.copy(f[d]),Ke(n,i,t,e),u=t.distanceToSquared(e),u<p&&(p=u,l&&l.copy(t),r&&r.copy(e))}return this.closestPointToPoint(c,t),u=c.distanceToSquared(t),u<p&&(p=u,l&&l.copy(t),r&&r.copy(c)),this.closestPointToPoint(o,t),u=o.distanceToSquared(t),u<p&&(p=u,l&&l.copy(t),r&&r.copy(o)),Math.sqrt(p)}}();st.prototype.intersectsTriangle=function(){const t=new st,e=new Array(3),n=new Array(3),s=new ft,i=new ft,l=new O,r=new O,c=new O,o=new O,f=new O,u=new ut,p=new ut,a=new ut,d=new O;function P(T,w,g){const y=T.points;let b=0,x=-1;for(let v=0;v<3;v++){const{start:S,end:_}=u;S.copy(y[v]),_.copy(y[(v+1)%3]),u.delta(r);const h=Se(w.distanceToPoint(S));if(Se(w.normal.dot(r))&&h){g.copy(u),b=2;break}const m=w.intersectLine(u,d);if(!m&&h&&d.copy(S),(m||h)&&!Se(d.distanceTo(_))){if(b<=1)(b===1?g.start:g.end).copy(d),h&&(x=b);else if(b>=2){(x===1?g.start:g.end).copy(d),b=2;break}if(b++,b===2&&x===-1)break}}return b}return function(w,g=null,y=!1){this.needsUpdate&&this.update(),w.isExtendedTriangle?w.needsUpdate&&w.update():(t.copy(w),t.update(),w=t);const b=this.plane,x=w.plane;if(Math.abs(b.normal.dot(x.normal))>1-1e-10){const v=this.satBounds,S=this.satAxes;n[0]=w.a,n[1]=w.b,n[2]=w.c;for(let m=0;m<4;m++){const A=v[m],M=S[m];if(s.setFromPoints(M,n),A.isSeparated(s))return!1}const _=w.satBounds,h=w.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let m=0;m<4;m++){const A=_[m],M=h[m];if(s.setFromPoints(M,e),A.isSeparated(s))return!1}for(let m=0;m<4;m++){const A=S[m];for(let M=0;M<4;M++){const C=h[M];if(l.crossVectors(A,C),s.setFromPoints(l,e),i.setFromPoints(l,n),s.isSeparated(i))return!1}}return g&&(y||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),g.start.set(0,0,0),g.end.set(0,0,0)),!0}else{const v=P(this,x,p);if(v===1&&w.containsPoint(p.end))return g&&(g.start.copy(p.end),g.end.copy(p.end)),!0;if(v!==2)return!1;const S=P(w,b,a);if(S===1&&this.containsPoint(a.end))return g&&(g.start.copy(a.end),g.end.copy(a.end)),!0;if(S!==2)return!1;if(p.delta(c),a.delta(o),c.dot(o)<0){let E=a.start;a.start=a.end,a.end=E}const _=p.start.dot(c),h=p.end.dot(c),m=a.start.dot(c),A=a.end.dot(c),M=h<m,C=_<A;return _!==A&&m!==h&&M===C?!1:(g&&(f.subVectors(p.start,a.start),f.dot(c)>0?g.start.copy(p.start):g.start.copy(a.start),f.subVectors(p.end,a.end),f.dot(c)<0?g.end.copy(p.end):g.end.copy(a.end)),!0)}}}();st.prototype.distanceToPoint=function(){const t=new O;return function(n){return this.closestPointToPoint(n,t),n.distanceTo(t)}}();st.prototype.distanceToTriangle=function(){const t=new O,e=new O,n=["a","b","c"],s=new ut,i=new ut;return function(r,c=null,o=null){const f=c||o?s:null;if(this.intersectsTriangle(r,f))return(c||o)&&(c&&f.getCenter(c),o&&f.getCenter(o)),0;let u=1/0;for(let p=0;p<3;p++){let a;const d=n[p],P=r[d];this.closestPointToPoint(P,t),a=P.distanceToSquared(t),a<u&&(u=a,c&&c.copy(t),o&&o.copy(P));const T=this[d];r.closestPointToPoint(T,t),a=T.distanceToSquared(t),a<u&&(u=a,c&&c.copy(T),o&&o.copy(t))}for(let p=0;p<3;p++){const a=n[p],d=n[(p+1)%3];s.set(this[a],this[d]);for(let P=0;P<3;P++){const T=n[P],w=n[(P+1)%3];i.set(r[T],r[w]),Ke(s,i,t,e);const g=t.distanceToSquared(e);g<u&&(u=g,c&&c.copy(t),o&&o.copy(e))}}return Math.sqrt(u)}}();class W{constructor(e,n,s){this.isOrientedBox=!0,this.min=new O,this.max=new O,this.matrix=new mt,this.invMatrix=new mt,this.points=new Array(8).fill().map(()=>new O),this.satAxes=new Array(3).fill().map(()=>new O),this.satBounds=new Array(3).fill().map(()=>new ft),this.alignedSatBounds=new Array(3).fill().map(()=>new ft),this.needsUpdate=!1,e&&this.min.copy(e),n&&this.max.copy(n),s&&this.matrix.copy(s)}set(e,n,s){this.min.copy(e),this.max.copy(n),this.matrix.copy(s),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}W.prototype.update=function(){return function(){const e=this.matrix,n=this.min,s=this.max,i=this.points;for(let f=0;f<=1;f++)for(let u=0;u<=1;u++)for(let p=0;p<=1;p++){const a=1*f|2*u|4*p,d=i[a];d.x=f?s.x:n.x,d.y=u?s.y:n.y,d.z=p?s.z:n.z,d.applyMatrix4(e)}const l=this.satBounds,r=this.satAxes,c=i[0];for(let f=0;f<3;f++){const u=r[f],p=l[f],a=1<<f,d=i[a];u.subVectors(c,d),p.setFromPoints(u,i)}const o=this.alignedSatBounds;o[0].setFromPointsField(i,"x"),o[1].setFromPointsField(i,"y"),o[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();W.prototype.intersectsBox=function(){const t=new ft;return function(n){this.needsUpdate&&this.update();const s=n.min,i=n.max,l=this.satBounds,r=this.satAxes,c=this.alignedSatBounds;if(t.min=s.x,t.max=i.x,c[0].isSeparated(t)||(t.min=s.y,t.max=i.y,c[1].isSeparated(t))||(t.min=s.z,t.max=i.z,c[2].isSeparated(t)))return!1;for(let o=0;o<3;o++){const f=r[o],u=l[o];if(t.setFromBox(f,n),u.isSeparated(t))return!1}return!0}}();W.prototype.intersectsTriangle=function(){const t=new st,e=new Array(3),n=new ft,s=new ft,i=new O;return function(r){this.needsUpdate&&this.update(),r.isExtendedTriangle?r.needsUpdate&&r.update():(t.copy(r),t.update(),r=t);const c=this.satBounds,o=this.satAxes;e[0]=r.a,e[1]=r.b,e[2]=r.c;for(let a=0;a<3;a++){const d=c[a],P=o[a];if(n.setFromPoints(P,e),d.isSeparated(n))return!1}const f=r.satBounds,u=r.satAxes,p=this.points;for(let a=0;a<3;a++){const d=f[a],P=u[a];if(n.setFromPoints(P,p),d.isSeparated(n))return!1}for(let a=0;a<3;a++){const d=o[a];for(let P=0;P<4;P++){const T=u[P];if(i.crossVectors(d,T),n.setFromPoints(i,e),s.setFromPoints(i,p),n.isSeparated(s))return!1}}return!0}}();W.prototype.closestPointToPoint=function(){return function(e,n){return this.needsUpdate&&this.update(),n.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),n}}();W.prototype.distanceToPoint=function(){const t=new O;return function(n){return this.closestPointToPoint(n,t),n.distanceTo(t)}}();W.prototype.distanceToBox=function(){const t=["x","y","z"],e=new Array(12).fill().map(()=>new ut),n=new Array(12).fill().map(()=>new ut),s=new O,i=new O;return function(r,c=0,o=null,f=null){if(this.needsUpdate&&this.update(),this.intersectsBox(r))return(o||f)&&(r.getCenter(i),this.closestPointToPoint(i,s),r.closestPointToPoint(s,i),o&&o.copy(s),f&&f.copy(i)),0;const u=c*c,p=r.min,a=r.max,d=this.points;let P=1/0;for(let w=0;w<8;w++){const g=d[w];i.copy(g).clamp(p,a);const y=g.distanceToSquared(i);if(y<P&&(P=y,o&&o.copy(g),f&&f.copy(i),y<u))return Math.sqrt(y)}let T=0;for(let w=0;w<3;w++)for(let g=0;g<=1;g++)for(let y=0;y<=1;y++){const b=(w+1)%3,x=(w+2)%3,v=g<<b|y<<x,S=1<<w|g<<b|y<<x,_=d[v],h=d[S];e[T].set(_,h);const A=t[w],M=t[b],C=t[x],E=n[T],N=E.start,z=E.end;N[A]=p[A],N[M]=g?p[M]:a[M],N[C]=y?p[C]:a[M],z[A]=a[A],z[M]=g?p[M]:a[M],z[C]=y?p[C]:a[M],T++}for(let w=0;w<=1;w++)for(let g=0;g<=1;g++)for(let y=0;y<=1;y++){i.x=w?a.x:p.x,i.y=g?a.y:p.y,i.z=y?a.z:p.z,this.closestPointToPoint(i,s);const b=i.distanceToSquared(s);if(b<P&&(P=b,o&&o.copy(s),f&&f.copy(i),b<u))return Math.sqrt(b)}for(let w=0;w<12;w++){const g=e[w];for(let y=0;y<12;y++){const b=n[y];Ke(g,b,s,i);const x=s.distanceToSquared(i);if(x<P&&(P=x,o&&o.copy(s),f&&f.copy(i),x<u))return Math.sqrt(x)}}return Math.sqrt(P)}}();class Xe{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}class Ws extends Xe{constructor(){super(()=>new st)}}const tt=new Ws;class Ks{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const e=[];let n=null;this.setBuffer=s=>{n&&e.push(n),n=s,this.float32Array=new Float32Array(s),this.uint16Array=new Uint16Array(s),this.uint32Array=new Uint32Array(s)},this.clearBuffer=()=>{n=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,e.length!==0&&this.setBuffer(e.pop())}}}const U=new Ks;let ht,Mt;const gt=[],Zt=new Xe(()=>new lt);function Xs(t,e,n,s,i,l){ht=Zt.getPrimitive(),Mt=Zt.getPrimitive(),gt.push(ht,Mt),U.setBuffer(t._roots[e]);const r=Fe(0,t.geometry,n,s,i,l);U.clearBuffer(),Zt.releasePrimitive(ht),Zt.releasePrimitive(Mt),gt.pop(),gt.pop();const c=gt.length;return c>0&&(Mt=gt[c-1],ht=gt[c-2]),r}function Fe(t,e,n,s,i=null,l=0,r=0){const{float32Array:c,uint16Array:o,uint32Array:f}=U;let u=t*2;if(X(u,o)){const a=Y(t,f),d=G(u,o);return I(t,c,ht),s(a,d,!1,r,l+t,ht)}else{let A=function(C){const{uint16Array:E,uint32Array:N}=U;let z=C*2;for(;!X(z,E);)C=Q(C),z=C*2;return Y(C,N)},M=function(C){const{uint16Array:E,uint32Array:N}=U;let z=C*2;for(;!X(z,E);)C=J(C,N),z=C*2;return Y(C,N)+G(z,E)};const a=Q(t),d=J(t,f);let P=a,T=d,w,g,y,b;if(i&&(y=ht,b=Mt,I(P,c,y),I(T,c,b),w=i(y),g=i(b),g<w)){P=d,T=a;const C=w;w=g,g=C,y=b}y||(y=ht,I(P,c,y));const x=X(P*2,o),v=n(y,x,w,r+1,l+P);let S;if(v===rn){const C=A(P),N=M(P)-C;S=s(C,N,!0,r+1,l+P,y)}else S=v&&Fe(P,e,n,s,i,l,r+1);if(S)return!0;b=Mt,I(T,c,b);const _=X(T*2,o),h=n(b,_,g,r+1,l+T);let m;if(h===rn){const C=A(T),N=M(T)-C;m=s(C,N,!0,r+1,l+T,b)}else m=h&&Fe(T,e,n,s,i,l,r+1);return!!m}}const Ot=new O,_e=new O;function Zs(t,e,n={},s=0,i=1/0){const l=s*s,r=i*i;let c=1/0,o=null;if(t.shapecast({boundsTraverseOrder:u=>(Ot.copy(e).clamp(u.min,u.max),Ot.distanceToSquared(e)),intersectsBounds:(u,p,a)=>a<c&&a<r,intersectsTriangle:(u,p)=>{u.closestPointToPoint(e,Ot);const a=e.distanceToSquared(Ot);return a<c&&(_e.copy(Ot),c=a,o=p),a<l}}),c===1/0)return null;const f=Math.sqrt(c);return n.point?n.point.copy(_e):n.point=_e.clone(),n.distance=f,n.faceIndex=o,n}const xt=new O,wt=new O,bt=new O,Yt=new Et,Gt=new Et,Qt=new Et,un=new O,fn=new O,pn=new O,Jt=new O;function Ys(t,e,n,s,i,l,r,c){let o;if(l===Bn?o=t.intersectTriangle(s,n,e,!0,i):o=t.intersectTriangle(e,n,s,l!==ls,i),o===null)return null;const f=t.origin.distanceTo(i);return f<r||f>c?null:{distance:f,point:i.clone()}}function Gs(t,e,n,s,i,l,r,c,o,f,u){xt.fromBufferAttribute(e,l),wt.fromBufferAttribute(e,r),bt.fromBufferAttribute(e,c);const p=Ys(t,xt,wt,bt,Jt,o,f,u);if(p){s&&(Yt.fromBufferAttribute(s,l),Gt.fromBufferAttribute(s,r),Qt.fromBufferAttribute(s,c),p.uv=Ut.getInterpolation(Jt,xt,wt,bt,Yt,Gt,Qt,new Et)),i&&(Yt.fromBufferAttribute(i,l),Gt.fromBufferAttribute(i,r),Qt.fromBufferAttribute(i,c),p.uv1=Ut.getInterpolation(Jt,xt,wt,bt,Yt,Gt,Qt,new Et)),n&&(un.fromBufferAttribute(n,l),fn.fromBufferAttribute(n,r),pn.fromBufferAttribute(n,c),p.normal=Ut.getInterpolation(Jt,xt,wt,bt,un,fn,pn,new O),p.normal.dot(t.direction)>0&&p.normal.multiplyScalar(-1));const a={a:l,b:r,c,normal:new O,materialIndex:0};Ut.getNormal(xt,wt,bt,a.normal),p.face=a,p.faceIndex=l}return p}function ye(t,e,n,s,i,l,r){const c=s*3;let o=c+0,f=c+1,u=c+2;const p=t.index;t.index&&(o=p.getX(o),f=p.getX(f),u=p.getX(u));const{position:a,normal:d,uv:P,uv1:T}=t.attributes,w=Gs(n,a,d,P,T,o,f,u,e,l,r);return w?(w.faceIndex=s,i&&i.push(w),w):null}function $(t,e,n,s){const i=t.a,l=t.b,r=t.c;let c=e,o=e+1,f=e+2;n&&(c=n.getX(c),o=n.getX(o),f=n.getX(f)),i.x=s.getX(c),i.y=s.getY(c),i.z=s.getZ(c),l.x=s.getX(o),l.y=s.getY(o),l.z=s.getZ(o),r.x=s.getX(f),r.y=s.getY(f),r.z=s.getZ(f)}function Qs(t,e,n,s,i,l,r,c){const{geometry:o,_indirectBuffer:f}=t;for(let u=s,p=s+i;u<p;u++)ye(o,e,n,u,l,r,c)}function Js(t,e,n,s,i,l,r){const{geometry:c,_indirectBuffer:o}=t;let f=1/0,u=null;for(let p=s,a=s+i;p<a;p++){let d;d=ye(c,e,n,p,null,l,r),d&&d.distance<f&&(u=d,f=d.distance)}return u}function ti(t,e,n,s,i,l,r){const{geometry:c}=n,{index:o}=c,f=c.attributes.position;for(let u=t,p=e+t;u<p;u++){let a;if(a=u,$(r,a*3,o,f),r.needsUpdate=!0,s(r,a,i,l))return!0}return!1}function ei(t,e=null){e&&Array.isArray(e)&&(e=new Set(e));const n=t.geometry,s=n.index?n.index.array:null,i=n.attributes.position;let l,r,c,o,f=0;const u=t._roots;for(let a=0,d=u.length;a<d;a++)l=u[a],r=new Uint32Array(l),c=new Uint16Array(l),o=new Float32Array(l),p(0,f),f+=l.byteLength;function p(a,d,P=!1){const T=a*2;if(c[T+15]===me){const g=r[a+6],y=c[T+14];let b=1/0,x=1/0,v=1/0,S=-1/0,_=-1/0,h=-1/0;for(let m=3*g,A=3*(g+y);m<A;m++){let M=s[m];const C=i.getX(M),E=i.getY(M),N=i.getZ(M);C<b&&(b=C),C>S&&(S=C),E<x&&(x=E),E>_&&(_=E),N<v&&(v=N),N>h&&(h=N)}return o[a+0]!==b||o[a+1]!==x||o[a+2]!==v||o[a+3]!==S||o[a+4]!==_||o[a+5]!==h?(o[a+0]=b,o[a+1]=x,o[a+2]=v,o[a+3]=S,o[a+4]=_,o[a+5]=h,!0):!1}else{const g=a+8,y=r[a+6],b=g+d,x=y+d;let v=P,S=!1,_=!1;e?v||(S=e.has(b),_=e.has(x),v=!S&&!_):(S=!0,_=!0);const h=v||S,m=v||_;let A=!1;h&&(A=p(g,d,v));let M=!1;m&&(M=p(y,d,v));const C=A||M;if(C)for(let E=0;E<3;E++){const N=g+E,z=y+E,V=o[N],Z=o[N+3],it=o[z],rt=o[z+3];o[a+E]=V<it?V:it,o[a+E+3]=Z>rt?Z:rt}return C}}}function yt(t,e,n,s,i){let l,r,c,o,f,u;const p=1/n.direction.x,a=1/n.direction.y,d=1/n.direction.z,P=n.origin.x,T=n.origin.y,w=n.origin.z;let g=e[t],y=e[t+3],b=e[t+1],x=e[t+3+1],v=e[t+2],S=e[t+3+2];return p>=0?(l=(g-P)*p,r=(y-P)*p):(l=(y-P)*p,r=(g-P)*p),a>=0?(c=(b-T)*a,o=(x-T)*a):(c=(x-T)*a,o=(b-T)*a),l>o||c>r||((c>l||isNaN(l))&&(l=c),(o<r||isNaN(r))&&(r=o),d>=0?(f=(v-w)*d,u=(S-w)*d):(f=(S-w)*d,u=(v-w)*d),l>u||f>r)?!1:((f>l||l!==l)&&(l=f),(u<r||r!==r)&&(r=u),l<=i&&r>=s)}function ni(t,e,n,s,i,l,r,c){const{geometry:o,_indirectBuffer:f}=t;for(let u=s,p=s+i;u<p;u++){let a=f?f[u]:u;ye(o,e,n,a,l,r,c)}}function si(t,e,n,s,i,l,r){const{geometry:c,_indirectBuffer:o}=t;let f=1/0,u=null;for(let p=s,a=s+i;p<a;p++){let d;d=ye(c,e,n,o?o[p]:p,null,l,r),d&&d.distance<f&&(u=d,f=d.distance)}return u}function ii(t,e,n,s,i,l,r){const{geometry:c}=n,{index:o}=c,f=c.attributes.position;for(let u=t,p=e+t;u<p;u++){let a;if(a=n.resolveTriangleIndex(u),$(r,a*3,o,f),r.needsUpdate=!0,s(r,a,i,l))return!0}return!1}function ri(t,e,n,s,i,l,r){U.setBuffer(t._roots[e]),Ue(0,t,n,s,i,l,r),U.clearBuffer()}function Ue(t,e,n,s,i,l,r){const{float32Array:c,uint16Array:o,uint32Array:f}=U,u=t*2;if(X(u,o)){const a=Y(t,f),d=G(u,o);Qs(e,n,s,a,d,i,l,r)}else{const a=Q(t);yt(a,c,s,l,r)&&Ue(a,e,n,s,i,l,r);const d=J(t,f);yt(d,c,s,l,r)&&Ue(d,e,n,s,i,l,r)}}const oi=["x","y","z"];function ci(t,e,n,s,i,l){U.setBuffer(t._roots[e]);const r=De(0,t,n,s,i,l);return U.clearBuffer(),r}function De(t,e,n,s,i,l){const{float32Array:r,uint16Array:c,uint32Array:o}=U;let f=t*2;if(X(f,c)){const p=Y(t,o),a=G(f,c);return Js(e,n,s,p,a,i,l)}else{const p=Rn(t,o),a=oi[p],P=s.direction[a]>=0;let T,w;P?(T=Q(t),w=J(t,o)):(T=J(t,o),w=Q(t));const y=yt(T,r,s,i,l)?De(T,e,n,s,i,l):null;if(y){const v=y.point[a];if(P?v<=r[w+p]:v>=r[w+p+3])return y}const x=yt(w,r,s,i,l)?De(w,e,n,s,i,l):null;return y&&x?y.distance<=x.distance?y:x:y||x||null}}const te=new lt,At=new st,vt=new st,zt=new mt,dn=new W,ee=new W;function li(t,e,n,s){U.setBuffer(t._roots[e]);const i=Ie(0,t,n,s);return U.clearBuffer(),i}function Ie(t,e,n,s,i=null){const{float32Array:l,uint16Array:r,uint32Array:c}=U;let o=t*2;if(i===null&&(n.boundingBox||n.computeBoundingBox(),dn.set(n.boundingBox.min,n.boundingBox.max,s),i=dn),X(o,r)){const u=e.geometry,p=u.index,a=u.attributes.position,d=n.index,P=n.attributes.position,T=Y(t,c),w=G(o,r);if(zt.copy(s).invert(),n.boundsTree)return I(t,l,ee),ee.matrix.copy(zt),ee.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:y=>ee.intersectsBox(y),intersectsTriangle:y=>{y.a.applyMatrix4(s),y.b.applyMatrix4(s),y.c.applyMatrix4(s),y.needsUpdate=!0;for(let b=T*3,x=(w+T)*3;b<x;b+=3)if($(vt,b,p,a),vt.needsUpdate=!0,y.intersectsTriangle(vt))return!0;return!1}});for(let g=T*3,y=(w+T)*3;g<y;g+=3){$(At,g,p,a),At.a.applyMatrix4(zt),At.b.applyMatrix4(zt),At.c.applyMatrix4(zt),At.needsUpdate=!0;for(let b=0,x=d.count;b<x;b+=3)if($(vt,b,d,P),vt.needsUpdate=!0,At.intersectsTriangle(vt))return!0}}else{const u=t+8,p=c[t+6];return I(u,l,te),!!(i.intersectsBox(te)&&Ie(u,e,n,s,i)||(I(p,l,te),i.intersectsBox(te)&&Ie(p,e,n,s,i)))}}const ne=new mt,Ce=new W,Rt=new W,ai=new O,ui=new O,fi=new O,pi=new O;function di(t,e,n,s={},i={},l=0,r=1/0){e.boundingBox||e.computeBoundingBox(),Ce.set(e.boundingBox.min,e.boundingBox.max,n),Ce.needsUpdate=!0;const c=t.geometry,o=c.attributes.position,f=c.index,u=e.attributes.position,p=e.index,a=tt.getPrimitive(),d=tt.getPrimitive();let P=ai,T=ui,w=null,g=null;i&&(w=fi,g=pi);let y=1/0,b=null,x=null;return ne.copy(n).invert(),Rt.matrix.copy(ne),t.shapecast({boundsTraverseOrder:v=>Ce.distanceToBox(v),intersectsBounds:(v,S,_)=>_<y&&_<r?(S&&(Rt.min.copy(v.min),Rt.max.copy(v.max),Rt.needsUpdate=!0),!0):!1,intersectsRange:(v,S)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:h=>Rt.distanceToBox(h),intersectsBounds:(h,m,A)=>A<y&&A<r,intersectsRange:(h,m)=>{for(let A=h,M=h+m;A<M;A++){$(d,3*A,p,u),d.a.applyMatrix4(n),d.b.applyMatrix4(n),d.c.applyMatrix4(n),d.needsUpdate=!0;for(let C=v,E=v+S;C<E;C++){$(a,3*C,f,o),a.needsUpdate=!0;const N=a.distanceToTriangle(d,P,w);if(N<y&&(T.copy(P),g&&g.copy(w),y=N,b=C,x=A),N<l)return!0}}}});{const _=Nt(e);for(let h=0,m=_;h<m;h++){$(d,3*h,p,u),d.a.applyMatrix4(n),d.b.applyMatrix4(n),d.c.applyMatrix4(n),d.needsUpdate=!0;for(let A=v,M=v+S;A<M;A++){$(a,3*A,f,o),a.needsUpdate=!0;const C=a.distanceToTriangle(d,P,w);if(C<y&&(T.copy(P),g&&g.copy(w),y=C,b=A,x=h),C<l)return!0}}}}}),tt.releasePrimitive(a),tt.releasePrimitive(d),y===1/0?null:(s.point?s.point.copy(T):s.point=T.clone(),s.distance=y,s.faceIndex=b,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(ne),T.applyMatrix4(ne),i.distance=T.sub(i.point).length(),i.faceIndex=x),s)}function hi(t,e=null){e&&Array.isArray(e)&&(e=new Set(e));const n=t.geometry,s=n.index?n.index.array:null,i=n.attributes.position;let l,r,c,o,f=0;const u=t._roots;for(let a=0,d=u.length;a<d;a++)l=u[a],r=new Uint32Array(l),c=new Uint16Array(l),o=new Float32Array(l),p(0,f),f+=l.byteLength;function p(a,d,P=!1){const T=a*2;if(c[T+15]===me){const g=r[a+6],y=c[T+14];let b=1/0,x=1/0,v=1/0,S=-1/0,_=-1/0,h=-1/0;for(let m=g,A=g+y;m<A;m++){const M=3*t.resolveTriangleIndex(m);for(let C=0;C<3;C++){let E=M+C;E=s?s[E]:E;const N=i.getX(E),z=i.getY(E),V=i.getZ(E);N<b&&(b=N),N>S&&(S=N),z<x&&(x=z),z>_&&(_=z),V<v&&(v=V),V>h&&(h=V)}}return o[a+0]!==b||o[a+1]!==x||o[a+2]!==v||o[a+3]!==S||o[a+4]!==_||o[a+5]!==h?(o[a+0]=b,o[a+1]=x,o[a+2]=v,o[a+3]=S,o[a+4]=_,o[a+5]=h,!0):!1}else{const g=a+8,y=r[a+6],b=g+d,x=y+d;let v=P,S=!1,_=!1;e?v||(S=e.has(b),_=e.has(x),v=!S&&!_):(S=!0,_=!0);const h=v||S,m=v||_;let A=!1;h&&(A=p(g,d,v));let M=!1;m&&(M=p(y,d,v));const C=A||M;if(C)for(let E=0;E<3;E++){const N=g+E,z=y+E,V=o[N],Z=o[N+3],it=o[z],rt=o[z+3];o[a+E]=V<it?V:it,o[a+E+3]=Z>rt?Z:rt}return C}}}function mi(t,e,n,s,i,l,r){U.setBuffer(t._roots[e]),je(0,t,n,s,i,l,r),U.clearBuffer()}function je(t,e,n,s,i,l,r){const{float32Array:c,uint16Array:o,uint32Array:f}=U,u=t*2;if(X(u,o)){const a=Y(t,f),d=G(u,o);ni(e,n,s,a,d,i,l,r)}else{const a=Q(t);yt(a,c,s,l,r)&&je(a,e,n,s,i,l,r);const d=J(t,f);yt(d,c,s,l,r)&&je(d,e,n,s,i,l,r)}}const yi=["x","y","z"];function gi(t,e,n,s,i,l){U.setBuffer(t._roots[e]);const r=$e(0,t,n,s,i,l);return U.clearBuffer(),r}function $e(t,e,n,s,i,l){const{float32Array:r,uint16Array:c,uint32Array:o}=U;let f=t*2;if(X(f,c)){const p=Y(t,o),a=G(f,c);return si(e,n,s,p,a,i,l)}else{const p=Rn(t,o),a=yi[p],P=s.direction[a]>=0;let T,w;P?(T=Q(t),w=J(t,o)):(T=J(t,o),w=Q(t));const y=yt(T,r,s,i,l)?$e(T,e,n,s,i,l):null;if(y){const v=y.point[a];if(P?v<=r[w+p]:v>=r[w+p+3])return y}const x=yt(w,r,s,i,l)?$e(w,e,n,s,i,l):null;return y&&x?y.distance<=x.distance?y:x:y||x||null}}const se=new lt,Pt=new st,Tt=new st,Vt=new mt,hn=new W,ie=new W;function xi(t,e,n,s){U.setBuffer(t._roots[e]);const i=qe(0,t,n,s);return U.clearBuffer(),i}function qe(t,e,n,s,i=null){const{float32Array:l,uint16Array:r,uint32Array:c}=U;let o=t*2;if(i===null&&(n.boundingBox||n.computeBoundingBox(),hn.set(n.boundingBox.min,n.boundingBox.max,s),i=hn),X(o,r)){const u=e.geometry,p=u.index,a=u.attributes.position,d=n.index,P=n.attributes.position,T=Y(t,c),w=G(o,r);if(Vt.copy(s).invert(),n.boundsTree)return I(t,l,ie),ie.matrix.copy(Vt),ie.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:y=>ie.intersectsBox(y),intersectsTriangle:y=>{y.a.applyMatrix4(s),y.b.applyMatrix4(s),y.c.applyMatrix4(s),y.needsUpdate=!0;for(let b=T,x=w+T;b<x;b++)if($(Tt,3*e.resolveTriangleIndex(b),p,a),Tt.needsUpdate=!0,y.intersectsTriangle(Tt))return!0;return!1}});for(let g=T,y=w+T;g<y;g++){const b=e.resolveTriangleIndex(g);$(Pt,3*b,p,a),Pt.a.applyMatrix4(Vt),Pt.b.applyMatrix4(Vt),Pt.c.applyMatrix4(Vt),Pt.needsUpdate=!0;for(let x=0,v=d.count;x<v;x+=3)if($(Tt,x,d,P),Tt.needsUpdate=!0,Pt.intersectsTriangle(Tt))return!0}}else{const u=t+8,p=c[t+6];return I(u,l,se),!!(i.intersectsBox(se)&&qe(u,e,n,s,i)||(I(p,l,se),i.intersectsBox(se)&&qe(p,e,n,s,i)))}}const re=new mt,Be=new W,Ft=new W,wi=new O,bi=new O,Ai=new O,vi=new O;function Pi(t,e,n,s={},i={},l=0,r=1/0){e.boundingBox||e.computeBoundingBox(),Be.set(e.boundingBox.min,e.boundingBox.max,n),Be.needsUpdate=!0;const c=t.geometry,o=c.attributes.position,f=c.index,u=e.attributes.position,p=e.index,a=tt.getPrimitive(),d=tt.getPrimitive();let P=wi,T=bi,w=null,g=null;i&&(w=Ai,g=vi);let y=1/0,b=null,x=null;return re.copy(n).invert(),Ft.matrix.copy(re),t.shapecast({boundsTraverseOrder:v=>Be.distanceToBox(v),intersectsBounds:(v,S,_)=>_<y&&_<r?(S&&(Ft.min.copy(v.min),Ft.max.copy(v.max),Ft.needsUpdate=!0),!0):!1,intersectsRange:(v,S)=>{if(e.boundsTree){const _=e.boundsTree;return _.shapecast({boundsTraverseOrder:h=>Ft.distanceToBox(h),intersectsBounds:(h,m,A)=>A<y&&A<r,intersectsRange:(h,m)=>{for(let A=h,M=h+m;A<M;A++){const C=_.resolveTriangleIndex(A);$(d,3*C,p,u),d.a.applyMatrix4(n),d.b.applyMatrix4(n),d.c.applyMatrix4(n),d.needsUpdate=!0;for(let E=v,N=v+S;E<N;E++){const z=t.resolveTriangleIndex(E);$(a,3*z,f,o),a.needsUpdate=!0;const V=a.distanceToTriangle(d,P,w);if(V<y&&(T.copy(P),g&&g.copy(w),y=V,b=E,x=A),V<l)return!0}}}})}else{const _=Nt(e);for(let h=0,m=_;h<m;h++){$(d,3*h,p,u),d.a.applyMatrix4(n),d.b.applyMatrix4(n),d.c.applyMatrix4(n),d.needsUpdate=!0;for(let A=v,M=v+S;A<M;A++){const C=t.resolveTriangleIndex(A);$(a,3*C,f,o),a.needsUpdate=!0;const E=a.distanceToTriangle(d,P,w);if(E<y&&(T.copy(P),g&&g.copy(w),y=E,b=A,x=h),E<l)return!0}}}}}),tt.releasePrimitive(a),tt.releasePrimitive(d),y===1/0?null:(s.point?s.point.copy(T):s.point=T.clone(),s.distance=y,s.faceIndex=b,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(re),T.applyMatrix4(re),i.distance=T.sub(i.point).length(),i.faceIndex=x),s)}function Ti(){return typeof SharedArrayBuffer<"u"}const jt=new U.constructor,fe=new U.constructor,dt=new Xe(()=>new lt),St=new lt,_t=new lt,Me=new lt,Ee=new lt;let Ne=!1;function Si(t,e,n,s){if(Ne)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Ne=!0;const i=t._roots,l=e._roots;let r,c=0,o=0;const f=new mt().copy(n).invert();for(let u=0,p=i.length;u<p;u++){jt.setBuffer(i[u]),o=0;const a=dt.getPrimitive();I(0,jt.float32Array,a),a.applyMatrix4(f);for(let d=0,P=l.length;d<P&&(fe.setBuffer(l[u]),r=nt(0,0,n,f,s,c,o,0,0,a),fe.clearBuffer(),o+=l[d].length,!r);d++);if(dt.releasePrimitive(a),jt.clearBuffer(),c+=i[u].length,r)break}return Ne=!1,r}function nt(t,e,n,s,i,l=0,r=0,c=0,o=0,f=null,u=!1){let p,a;u?(p=fe,a=jt):(p=jt,a=fe);const d=p.float32Array,P=p.uint32Array,T=p.uint16Array,w=a.float32Array,g=a.uint32Array,y=a.uint16Array,b=t*2,x=e*2,v=X(b,T),S=X(x,y);let _=!1;if(S&&v)u?_=i(Y(e,g),G(e*2,y),Y(t,P),G(t*2,T),o,r+e,c,l+t):_=i(Y(t,P),G(t*2,T),Y(e,g),G(e*2,y),c,l+t,o,r+e);else if(S){const h=dt.getPrimitive();I(e,w,h),h.applyMatrix4(n);const m=Q(t),A=J(t,P);I(m,d,St),I(A,d,_t);const M=h.intersectsBox(St),C=h.intersectsBox(_t);_=M&&nt(e,m,s,n,i,r,l,o,c+1,h,!u)||C&&nt(e,A,s,n,i,r,l,o,c+1,h,!u),dt.releasePrimitive(h)}else{const h=Q(e),m=J(e,g);I(h,w,Me),I(m,w,Ee);const A=f.intersectsBox(Me),M=f.intersectsBox(Ee);if(A&&M)_=nt(t,h,n,s,i,l,r,c,o+1,f,u)||nt(t,m,n,s,i,l,r,c,o+1,f,u);else if(A)if(v)_=nt(t,h,n,s,i,l,r,c,o+1,f,u);else{const C=dt.getPrimitive();C.copy(Me).applyMatrix4(n);const E=Q(t),N=J(t,P);I(E,d,St),I(N,d,_t);const z=C.intersectsBox(St),V=C.intersectsBox(_t);_=z&&nt(h,E,s,n,i,r,l,o,c+1,C,!u)||V&&nt(h,N,s,n,i,r,l,o,c+1,C,!u),dt.releasePrimitive(C)}else if(M)if(v)_=nt(t,m,n,s,i,l,r,c,o+1,f,u);else{const C=dt.getPrimitive();C.copy(Ee).applyMatrix4(n);const E=Q(t),N=J(t,P);I(E,d,St),I(N,d,_t);const z=C.intersectsBox(St),V=C.intersectsBox(_t);_=z&&nt(m,E,s,n,i,r,l,o,c+1,C,!u)||V&&nt(m,N,s,n,i,r,l,o,c+1,C,!u),dt.releasePrimitive(C)}}return _}const oe=new W,mn=new lt,_i={strategy:Ln,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0};class Ze{static serialize(e,n={}){n={cloneBuffers:!0,...n};const s=e.geometry,i=e._roots,l=e._indirectBuffer,r=s.getIndex();let c;return n.cloneBuffers?c={roots:i.map(o=>o.slice()),index:r?r.array.slice():null,indirectBuffer:l?l.slice():null}:c={roots:i,index:r?r.array:null,indirectBuffer:l},c}static deserialize(e,n,s={}){s={setIndex:!0,indirect:!!e.indirectBuffer,...s};const{index:i,roots:l,indirectBuffer:r}=e,c=new Ze(n,{...s,[ve]:!0});if(c._roots=l,c._indirectBuffer=r||null,s.setIndex){const o=n.getIndex();if(o===null){const f=new Mn(e.index,1,!1);n.setIndex(f)}else o.array!==i&&(o.array.set(i),o.needsUpdate=!0)}return c}get indirect(){return!!this._indirectBuffer}constructor(e,n={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(n=Object.assign({..._i,[ve]:!1},n),n.useSharedArrayBuffer&&!Ti())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,n[ve]||(js(this,n),!e.boundingBox&&n.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new lt))),this.resolveTriangleIndex=n.indirect?s=>this._indirectBuffer[s]:s=>s}refit(e=null){return(this.indirect?hi:ei)(this,e)}traverse(e,n=0){const s=this._roots[n],i=new Uint32Array(s),l=new Uint16Array(s);r(0);function r(c,o=0){const f=c*2,u=l[f+15]===me;if(u){const p=i[c+6],a=l[f+14];e(o,u,new Float32Array(s,c*4,6),p,a)}else{const p=c+It/4,a=i[c+6],d=i[c+7];e(o,u,new Float32Array(s,c*4,6),d)||(r(p,o+1),r(a,o+1))}}}raycast(e,n=nn,s=0,i=1/0){const l=this._roots,r=this.geometry,c=[],o=n.isMaterial,f=Array.isArray(n),u=r.groups,p=o?n.side:n,a=this.indirect?mi:ri;for(let d=0,P=l.length;d<P;d++){const T=f?n[u[d].materialIndex].side:p,w=c.length;if(a(this,d,T,e,c,s,i),f){const g=u[d].materialIndex;for(let y=w,b=c.length;y<b;y++)c[y].face.materialIndex=g}}return c}raycastFirst(e,n=nn,s=0,i=1/0){const l=this._roots,r=this.geometry,c=n.isMaterial,o=Array.isArray(n);let f=null;const u=r.groups,p=c?n.side:n,a=this.indirect?gi:ci;for(let d=0,P=l.length;d<P;d++){const T=o?n[u[d].materialIndex].side:p,w=a(this,d,T,e,s,i);w!=null&&(f==null||w.distance<f.distance)&&(f=w,o&&(w.face.materialIndex=u[d].materialIndex))}return f}intersectsGeometry(e,n){let s=!1;const i=this._roots,l=this.indirect?xi:li;for(let r=0,c=i.length;r<c&&(s=l(this,r,e,n),!s);r++);return s}shapecast(e){const n=tt.getPrimitive(),s=this.indirect?ii:ti;let{boundsTraverseOrder:i,intersectsBounds:l,intersectsRange:r,intersectsTriangle:c}=e;if(r&&c){const p=r;r=(a,d,P,T,w)=>p(a,d,P,T,w)?!0:s(a,d,this,c,P,T,n)}else r||(c?r=(p,a,d,P)=>s(p,a,this,c,d,P,n):r=(p,a,d)=>d);let o=!1,f=0;const u=this._roots;for(let p=0,a=u.length;p<a;p++){const d=u[p];if(o=Xs(this,p,l,r,i,f),o)break;f+=d.byteLength}return tt.releasePrimitive(n),o}bvhcast(e,n,s){let{intersectsRanges:i,intersectsTriangles:l}=s;const r=tt.getPrimitive(),c=this.geometry.index,o=this.geometry.attributes.position,f=this.indirect?P=>{const T=this.resolveTriangleIndex(P);$(r,T*3,c,o)}:P=>{$(r,P*3,c,o)},u=tt.getPrimitive(),p=e.geometry.index,a=e.geometry.attributes.position,d=e.indirect?P=>{const T=e.resolveTriangleIndex(P);$(u,T*3,p,a)}:P=>{$(u,P*3,p,a)};if(l){const P=(T,w,g,y,b,x,v,S)=>{for(let _=g,h=g+y;_<h;_++){d(_),u.a.applyMatrix4(n),u.b.applyMatrix4(n),u.c.applyMatrix4(n),u.needsUpdate=!0;for(let m=T,A=T+w;m<A;m++)if(f(m),r.needsUpdate=!0,l(r,u,m,_,b,x,v,S))return!0}return!1};if(i){const T=i;i=function(w,g,y,b,x,v,S,_){return T(w,g,y,b,x,v,S,_)?!0:P(w,g,y,b,x,v,S,_)}}else i=P}return Si(this,e,n,i)}intersectsBox(e,n){return oe.set(e.min,e.max,n),oe.needsUpdate=!0,this.shapecast({intersectsBounds:s=>oe.intersectsBox(s),intersectsTriangle:s=>oe.intersectsTriangle(s)})}intersectsSphere(e){return this.shapecast({intersectsBounds:n=>e.intersectsBox(n),intersectsTriangle:n=>n.intersectsSphere(e)})}closestPointToGeometry(e,n,s={},i={},l=0,r=1/0){return(this.indirect?Pi:di)(this,e,n,s,i,l,r)}closestPointToPoint(e,n={},s=0,i=1/0){return Zs(this,e,n,s,i)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(s=>{I(0,new Float32Array(s),mn),e.union(mn)}),e}}function yn(t,e,n){return t===null?null:(t.point.applyMatrix4(e.matrixWorld),t.distance=t.point.distanceTo(n.ray.origin),t.object=e,t)}const ce=new as,gn=new O,xn=new mt,Ci=Nn.prototype.raycast,wn=new O;function Bi(t,e){if(this.geometry.boundsTree){if(this.material===void 0)return;xn.copy(this.matrixWorld).invert(),ce.copy(t.ray).applyMatrix4(xn),Ni(this.matrixWorld,wn),gn.copy(ce.direction).multiply(wn);const n=gn.length(),s=t.near/n,i=t.far/n,l=this.geometry.boundsTree;if(t.firstHitOnly===!0){const r=yn(l.raycastFirst(ce,this.material,s,i),this,t);r&&e.push(r)}else{const r=l.raycast(ce,this.material,s,i);for(let c=0,o=r.length;c<o;c++){const f=yn(r[c],this,t);f&&e.push(f)}}}else Ci.call(this,t,e)}function Mi(t){return this.boundsTree=new Ze(this,t),this.boundsTree}function Ei(){this.boundsTree=null}function Ni(t,e){const n=t.elements,s=e.set(n[0],n[1],n[2]).length(),i=e.set(n[4],n[5],n[6]).length(),l=e.set(n[8],n[9],n[10]).length();return e.set(s,i,l)}us({OutlineEffect:vs});const ke=[],Le=[];function ki({modelIn:t,modelOut:e,modelInCopy:n,modelInCopy2:s,modelOutCopy:i}){sn.prototype.computeBoundsTree=Mi,sn.prototype.disposeBoundsTree=Ei,Nn.prototype.raycast=Bi,console.log("render count");const{gl:l,camera:r,scene:c}=fs(),o=B.useRef(),f=B.useRef();B.useRef(),B.useRef(),B.useRef(),l.setPixelRatio(Math.min(window.devicePixelRatio,2));let{stepCount:u,modelProperties:p,partsInOut:a,setVisibleModel:d,setCurrentStepObj:P,currentStepObject:T,selectedParts:w,setProperties:g,setCurrentObject:y,visibleObj:b}=B.useContext(et);const[x,v]=B.useState(!1),[S,_]=B.useState(!1),[h,m]=B.useState(s);B.useState();const[A,M]=B.useState(n);B.useState(s),B.useState(),B.useState(),B.useState();const[C,E]=B.useState(),[N,z]=B.useState();B.useState();const V=new Wt({color:15461355}),Z=new Wt({color:16777215}),it=new Wt({color:16711680,wireframe:!0}),rt=new Wt({color:13754592});var Ye=new xe({color:4210752,linewidth:10}),Ge=new xe({color:6723993,linewidth:50}),qn=new xe({color:10921638,linewidth:10});new Cn(ps).uniforms.diffuse.value.set(0);const Hn=[],qt=[["021_Prepare_the_head_front_plate"],["022_Prepare_the_head_back_plate","023_Fix_the_bottom_carriage"],["051_Prepare_pinch_roller","052_Fix_front_shaft","053_Fix_the_spring"],["17_Prepare_Y_motor_holder"],["20_Install_electronics"],["21_Prepare_Side_Cover"]],Wn=["22_Wiring_and_cable_management"],Qe=[];let Ht=[],kt=[];B.useEffect(()=>{a===!0?(m(s),z(s.getObjectByName(x[u]))):a===!1&&(m(i),z(i.getObjectByName(x[u])))},[a]),B.useEffect(()=>{h.traverse(L=>{L.isObject3D&&!L.isMesh&&!L.isGroup&&(ke.push(L.name),Le.push(L.userData.name))},[]),ke.sort(),v(ke),Le.sort(),_(Le),A.traverse(L=>{if(L.isMesh){L.material=V,L.frustumCulled=!1;var R=new we(L.geometry,20),D=new be(R,qn);L.add(D),L.geometry.dispose(),V.dispose()}}),P(n.getObjectByName(x[0])),z(h.getObjectByName(x[0])),Je()},[]);const Kn=Hn.some(L=>L.includes(x[u])),Xn=qt.some(L=>L.includes(x[u]));q(L=>L.wiringStep);const Zn=q(L=>L.isWiringStep),Yn=q(L=>L.isNotWiringStep);Wn.some(L=>L.includes(x[u]))?Zn():Yn(),B.useEffect(()=>{P(s.getObjectByName(x[u])),z(h.getObjectByName(x[u]))},[x,u]),B.useEffect(()=>{console.log(T),Je()},[x,u,T]),B.useEffect(()=>{N&&(y(N.getObjectByName(x[u])),w!=[]&&ts())},[w,N]);const Je=B.useCallback(()=>{let L=[],R=[];const D=[];if(T){for(let K=0;K<T.children.length;K++)T.children[K].traverse(ot=>{ot.isGroup&&ot.userData.name!=null&&D.push(ot.userData.name),L=[...new Set(D)],R=L.map(tn=>[D.filter(ss=>ss===tn).length,tn])});const j=T.userData.name;g({partsNames:R,titleName:j})}}),Gn=B.useCallback(()=>{for(let L=u-1;L>=0;L--)for(let R=kt.length-1;R>=0;R--)if(x[L]===kt[R]){let D=A.getObjectByName(`${x[L]}`,!0);if(Ht.push(D),x[L+1]==="023_Fix_the_bottom_carriage"){let j=A.getObjectByName("022_Prepare_the_head_back_plate",!0),K=A.getObjectByName("021_Prepare_the_head_front_plate",!0);Ht.push(j),Ht.push(K)}}}),Qn=B.useCallback(()=>{for(let D=0;D<qt.length;D++){kt=qt[D];for(let j=0;j<kt.length;j++)kt.some(ot=>ot.includes(x[u]))&&Gn()}let L=new ue,R=N.clone();L.add(R),Ht.filter(D=>qt.some(j=>j.includes(D.name))).forEach(D=>{D.visible=!0;let j=D.clone();L.add(j)}),d(L)}),Jn=B.useCallback(()=>{for(let j=u-1;j>=0;j--){let K=A.getObjectByName(`${x[j]}`,!0);Qe.push(K)}let L=[];x[u]==="24_Fix_side_covers"&&(L=["21_Prepare_Side_Cover"],console.log("exception"));let R=new ue;Qe.filter(j=>!L.some(K=>K.includes(j.name))).forEach(j=>{j.visible=!0;let K=j.clone();R.add(K)});let D=N.clone();R.add(D),d(R)}),ts=B.useCallback(()=>{if(N){for(let L=0;L<N.children.length;L++)N.children[L].traverse(R=>{if(R.isMesh&&w.includes(N.children[L].userData.name)){R.frustumCulled=!1,R.geometry.clone(),R.material=rt;var D=new we(R.geometry,20),j=new be(D,Ge);R.add(j),rt.dispose(),D.dispose(),Ge.dispose()}else if(R.isMesh&&N.children[L].userData.name!="Curves"){R.frustumCulled=!1,R.material=Z;var D=new we(R.geometry,20),K=new be(D,Ye);R.add(K),D.dispose(),Ye.dispose()}else if(R.userData.name==="Curves"&&(R.material=it,R.isGroup))for(let ot=0;ot<R.children.length;ot++)R.children[ot].isMesh&&(R.children[ot].material=it)});E(w)}}),es=B.useCallback(()=>{if(N){N.clone();for(let L=0;L<h.children.length;L++)h.children[L].visible=!1;for(let L=0;L<A.children.length;L++)A.children[L].visible=!1;Kn?(console.log("exception"),N.visible=!0,d(N)):Xn?(console.log("preparing step"),N.visible=!0,Qn()):(console.log("main building step"),N.visible=!0,Jn())}},[N]);B.useEffect(()=>{es()},[N]);const{setListOfStep:ns}=B.useContext(et);return ns(S),B.useState(null),k(H,{children:k(Ts,{children:x?F(H,{children:[k("primitive",{ref:o,object:h,scale:1.0001}),k("primitive",{ref:f,object:A,scale:1})]}):null})})}const Li=ct.memo(ki);function Oi(){let t=[],e=new ue;const{modelProperties:n,visibleObj:s,currentStepObject:i,setClickedParts:l,selectedParts:r,partsInOut:c,setCurrentPartsModel:o,currentObject:f,partBtnState:u,setPartButtonState:p}=B.useContext(et),[a,d]=B.useState(null);B.useState(!1);const[P,T]=B.useState(!1),w=q(x=>x.wiringStep),g=B.useCallback(()=>{if(e=new ue,t=[],a){console.log(a);for(let x=0;x<f.children.length;x++)if(f.children[x].userData.name===a){const v=f.children[x].clone();e.add(v),t.push(f.children[x].userData.name)}l(t),o(e)}});B.useEffect(()=>{t=[],l(t),g()},[i,a]),B.useEffect(()=>{p(!1),t=[],l(t),o(null)},[i]);const y=()=>{u===!0&&(p(!1),t=[],l(t),o(null)),u===!1&&(p(!0),g())},b=()=>{console.log("disable"),p(!1),t=[],l(t),o(null),d(null)};return k(H,{children:k("div",{children:k("ul",{children:n?n.partsNames.map(([x,v],S)=>k("li",{children:v===a?F("button",{id:`${v}`,style:{backgroundColor:"#669999",color:"#ffffff"},disabled:P,onClick:()=>{u===!0&&b()},className:"parts",children:[F("b",{children:[" ",x,"x"]}),"  ",v]}):w?F("p",{style:{paddingBottom:10},children:[F("b",{children:[" ",x,"x"]}),"  ",v]}):F("button",{id:`${v}`,disabled:P,onClick:()=>{d(v),y()},className:"parts",children:[F("b",{children:[" ",x,"x "]}),"  ",v]})},S)):null})})})}function zi(){const{modelProperties:t}=B.useContext(et);return k(H,{children:k("div",{children:t?t.titleName:null})})}function Ri(){const{stepList:t,setStepPosition:e,stepCount:n,currentStepName:s,modelProperties:i}=B.useContext(et);B.useState("stepNaviBtn");const[l,r]=B.useState();return t&&[...Array(t.length)],k("div",{children:k("ul",{children:t?t.map((c,o)=>k("li",{children:i&&c===i.titleName?k("button",{id:`${c}`,style:{backgroundColor:"#000000",color:"#ffffff"},onClick:()=>{e(o)},className:"stepNaviBtn",children:c}):k("button",{id:`${c}`,style:{backgroundColor:l},onClick:()=>{e(o)},className:"stepNaviBtn",children:c})},o)):null})})}const Vi=ct.memo(Ri);function Fi({cameraControlsRef:t}){let{visibleObj:e,modelProperties:n,selectedPartsModel:s,selectedParts:i,currentObject:l,setCamera:r,partBtnState:c,currentStepObject:o}=B.useContext(et);const f=kn(),u=q(p=>p.cameraPositionTag);B.useEffect(()=>{e?f.refresh(e).fit():f.refresh(o).fit()},[o,u]),B.useEffect(()=>{s?f.refresh(s).fit():s||f.refresh(e).fit()},[s])}let He=1,Un=new Array;new Array;let Oe=new Array,le;We.get("https://sheets.googleapis.com/v4/spreadsheets/1LOopooeNjhdzCfvu5zUAM77Gak6xyd6BK8abQuMvPiA/values/Workbook?key=AIzaSyCqcO7MQv4dsj76ps3nNJnMwTT8Cvqv-eM").then(t=>{let e=t.data.values,n=new Array;for(const s of e)He>2&&s[1]!=""&&(Un.push(n),n=new Array),n.push(s),++He});function Ui(){let{stepCount:t}=B.useContext(et);return B.useEffect(()=>{le=new Array;for(const e of Un[t+1])e[10]!=""&&e[10]!=null&&(Oe=new Array,Oe.push(e[10]),le.push(Oe)),++He},[t]),k(H,{children:le?F("div",{children:[F("div",{id:"RemarksTitle",style:{margin:"auto",display:"inline",alignContent:"baseline"},children:[k("h3",{children:" Remarks"})," ",k("br",{})]}),k("ul",{children:le.map((e,n)=>F("li",{children:[" ",e]},n))})]}):null})}/**
  * react-collapsed v4.2.0
  *
  * Copyright (c) 2019-2024, Rogin Farrer
  *
  * This source code is licensed under the MIT license found in the
  * LICENSE.md file in the root directory of this source tree.
  *
  * @license MIT
  */var Di=class extends Error{constructor(t){super(`react-collapsed: ${t}`)}},pe=(...t)=>(t[0],`${t[1]}`,void 0);function Dn(t){const e=B.useRef(t);return B.useEffect(()=>{e.current=t}),B.useCallback((...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function Ii(t,e,n){const[s,i]=B.useState(e),l=B.useRef(typeof t<"u"),r=l.current?t:s,c=Dn(n),o=B.useCallback(f=>{const p=typeof f=="function"?f(r):f;l.current||i(p),c==null||c(p)},[c,r]);return B.useEffect(()=>{pe(!(l.current&&t==null),"`isExpanded` state is changing from controlled to uncontrolled. useCollapse should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled collapse for the lifetime of the component. Check the `isExpanded` prop."),pe(!(!l.current&&t!=null),"`isExpanded` state is changing from uncontrolled to controlled. useCollapse should not switch from uncontrolled to controlled (or vice versa). Decide between using a controlled or uncontrolled collapse for the lifetime of the component. Check the `isExpanded` prop.")},[t]),[r,o]}var ji="(prefers-reduced-motion: reduce)";function $i(){const[t,e]=B.useState(!1);return B.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const n=window.matchMedia(ji);e(n.matches);const s=i=>{e(i.matches)};if(n.addEventListener)return n.addEventListener("change",s),()=>{n.removeEventListener("change",s)};if(n.addListener)return n.addListener(s),()=>{n.removeListener(s)}},[]),t}var qi=ds["useId".toString()]||(()=>{});function Hi(){return qi()??""}var Wi=typeof window<"u"?B.useLayoutEffect:B.useEffect,ze=!1,Ki=0,bn=()=>++Ki;function Xi(t){const e=t||(ze?bn():null),[n,s]=B.useState(e);return Wi(()=>{n===null&&s(bn())},[]),B.useEffect(()=>{ze===!1&&(ze=!0)},[]),n!=null?String(n):void 0}function Zi(t){const e=Hi(),n=Xi(t);return typeof t=="string"?t:typeof e=="string"?e:n}function Yi(t,e){const n=performance.now(),s={};function i(){s.id=requestAnimationFrame(l=>{l-n>e?t():i()})}return i(),s}function An(t){t.id&&cancelAnimationFrame(t.id)}function vn(t){return t!=null&&t.current?t.current.scrollHeight:(pe(!0,"Was not able to find a ref to the collapse element via `getCollapseProps`. Ensure that the element exposes its `ref` prop. If it exposes the ref prop under a different name (like `innerRef`), use the `refKey` property to change it. Example:\n\nconst collapseProps = getCollapseProps({refKey: 'innerRef'})"),0)}function Gi(t){if(!t||typeof t=="string")return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function Qi(t,e){if(t!=null)if(typeof t=="function")t(e);else try{t.current=e}catch{throw new Di(`Cannot assign value "${e}" to ref "${t}"`)}}function Pn(...t){return t.every(e=>e==null)?null:e=>{t.forEach(n=>{Qi(n,e)})}}function Ji(t){let e=n=>{};e=n=>{if(!(n!=null&&n.current))return;const{paddingTop:s,paddingBottom:i}=window.getComputedStyle(n.current);pe(!(s&&s!=="0px"||i&&i!=="0px"),`Padding applied to the collapse element will cause the animation to break and not perform as expected. To fix, apply equivalent padding to the direct descendent of the collapse element. Example:

Before:   <div {...getCollapseProps({style: {padding: 10}})}>{children}</div>

After:   <div {...getCollapseProps()}>
             <div style={{padding: 10}}>
                 {children}
             </div>
          </div>`)},B.useEffect(()=>{e(t)},[t])}var tr=typeof window>"u"?B.useEffect:B.useLayoutEffect;function er({duration:t,easing:e="cubic-bezier(0.4, 0, 0.2, 1)",onTransitionStateChange:n=()=>{},isExpanded:s,defaultExpanded:i=!1,hasDisabledAnimation:l,id:r,...c}={}){const o=Dn(n),f=Zi(r?`${r}`:void 0),[u,p]=Ii(s,i),a=B.useRef(u),[d,P]=B.useState(!1),T=$i(),w=l??T,g=B.useRef(),y=B.useRef(),b=B.useRef(null),[x,v]=B.useState(null);Ji(b);const S=`${c.collapsedHeight||0}px`;function _(h){if(!b.current)return;const m=b.current;for(const A in h){const M=h[A];M?m.style[A]=M:m.style.removeProperty(A)}}return tr(()=>{if(!b.current||u===a.current)return;a.current=u;function m(C){return w?0:t??Gi(C)}const A=C=>`height ${m(C)}ms ${e}`,M=C=>{function E(){u?(_({height:"",overflow:"",transition:"",display:""}),o("expandEnd")):(_({transition:""}),o("collapseEnd")),P(!1)}y.current&&An(y.current),y.current=Yi(E,C)};return P(!0),u?g.current=requestAnimationFrame(()=>{o("expandStart"),_({display:"block",overflow:"hidden",height:S}),g.current=requestAnimationFrame(()=>{o("expanding");const C=vn(b);M(m(C)),b.current&&(b.current.style.transition=A(C),b.current.style.height=`${C}px`)})}):g.current=requestAnimationFrame(()=>{o("collapseStart");const C=vn(b);M(m(C)),_({transition:A(C),height:`${C}px`}),g.current=requestAnimationFrame(()=>{o("collapsing"),_({height:S,overflow:"hidden"})})}),()=>{g.current&&cancelAnimationFrame(g.current),y.current&&An(y.current)}},[u,S,w,t,e,o]),{isExpanded:u,setExpanded:p,getToggleProps(h){const{disabled:m,onClick:A,refKey:M,...C}={refKey:"ref",onClick(){},disabled:!1,...h},E=x?x.tagName==="BUTTON":void 0,N=h==null?void 0:h[M||"ref"],z={id:`react-collapsed-toggle-${f}`,"aria-controls":`react-collapsed-panel-${f}`,"aria-expanded":u,onClick(it){m||(A==null||A(it),p(rt=>!rt))},[M||"ref"]:Pn(N,v)},V={type:"button",disabled:m?!0:void 0},Z={"aria-disabled":m?!0:void 0,role:"button",tabIndex:m?-1:0};return E===!1?{...z,...Z,...C}:E===!0?{...z,...V,...C}:{...z,...V,...Z,...C}},getCollapseProps(h){const{style:m,refKey:A}={refKey:"ref",style:{},...h},M=h==null?void 0:h[A||"ref"];return{id:`react-collapsed-panel-${f}`,"aria-hidden":!u,"aria-labelledby":`react-collapsed-toggle-${f}`,role:"region",...h,[A||"ref"]:Pn(b,M),style:{boxSizing:"border-box",...!d&&!u?{display:S==="0px"?"none":"block",height:S,overflow:"hidden"}:{},...m}}}}}var In={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Tn=ct.createContext&&ct.createContext(In),nr=["attr","size","title"];function sr(t,e){if(t==null)return{};var n=ir(t,e),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(i=0;i<l.length;i++)s=l[i],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function ir(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function de(){return de=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},de.apply(this,arguments)}function Sn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,s)}return n}function he(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Sn(Object(n),!0).forEach(function(s){rr(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function rr(t,e,n){return e=or(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function or(t){var e=cr(t,"string");return typeof e=="symbol"?e:e+""}function cr(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jn(t){return t&&t.map((e,n)=>ct.createElement(e.tag,he({key:n},e.attr),jn(e.child)))}function ge(t){return e=>ct.createElement(lr,de({attr:he({},t.attr)},e),jn(t.child))}function lr(t){var e=n=>{var{attr:s,size:i,title:l}=t,r=sr(t,nr),c=i||n.size||"1em",o;return n.className&&(o=n.className),t.className&&(o=(o?o+" ":"")+t.className),ct.createElement("svg",de({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,r,{className:o,style:he(he({color:t.color||n.color},n.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),l&&ct.createElement("title",null,l),t.children)};return Tn!==void 0?ct.createElement(Tn.Consumer,null,n=>e(n)):e(In)}function _n(t){return ge({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"},child:[]},{tag:"path",attr:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0 1 30.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1 0 80 0 40 40 0 1 0-80 0z"},child:[]}]})(t)}function ar(t){return ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m18.25 7.6-5.5-3.18a1.49 1.49 0 0 0-1.5 0L5.75 7.6c-.46.27-.75.76-.75 1.3v6.35c0 .54.29 1.03.75 1.3l5.5 3.18c.46.27 1.04.27 1.5 0l5.5-3.18c.46-.27.75-.76.75-1.3V8.9c0-.54-.29-1.03-.75-1.3zM7 14.96v-4.62l4 2.32v4.61l-4-2.31zm5-4.03L8 8.61l4-2.31 4 2.31-4 2.32zm1 6.34v-4.61l4-2.32v4.62l-4 2.31zM7 2H3.5C2.67 2 2 2.67 2 3.5V7h2V4h3V2zm10 0h3.5c.83 0 1.5.67 1.5 1.5V7h-2V4h-3V2zM7 22H3.5c-.83 0-1.5-.67-1.5-1.5V17h2v3h3v2zm10 0h3.5c.83 0 1.5-.67 1.5-1.5V17h-2v3h-3v2z"},child:[]}]})(t)}function ur(t){return ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14l-6-6z"},child:[]}]})(t)}function fr(t){return ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M24 24H0V0h24v24z",opacity:".87"},child:[]},{tag:"path",attr:{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"},child:[]}]})(t)}let $t=1,$n=new Array,Ct=new Array;We.get("https://sheets.googleapis.com/v4/spreadsheets/1LOopooeNjhdzCfvu5zUAM77Gak6xyd6BK8abQuMvPiA/values/Workbook?key=AIzaSyCqcO7MQv4dsj76ps3nNJnMwTT8Cvqv-eM").then(t=>{let e=t.data.values,n=new Array;for(const s of e)$t>2&&s[1]!=""&&($n.push(n),n=new Array),n.push(s),++$t});function pr(){const[t,e]=B.useState(),[n,s]=B.useState(),[i,l]=B.useState(),r=q(d=>d.isNotVisibleToggle),c=q(d=>d.isVisibleToggle);q(d=>d.isVisible);let{stepCount:o,howToData:f,setHowToWorkbook:u,setClickedPath:p,path:a}=B.useContext(et);return B.useEffect(()=>{let d=new Array;We.get("https://sheets.googleapis.com/v4/spreadsheets/1grTucZ2sqLgZ4AtJq8EkyO__kLg-pazRVl3sbLNMaIY/values/Blad1?key=AIzaSyCqcO7MQv4dsj76ps3nNJnMwTT8Cvqv-eM").then(P=>{let T=P.data.values,w=new Array,g=[];for(const y of T)$t>0&&y[0]!=""?(w=new Array,w.push(y),d.push(w)):w.push(y),++$t;u(d);for(const y of d)y[0]!=""&&(Ct=new Array,Ct.push(y[0][0],y[0][1]),g.push(Ct));l(g)})},[]),B.useEffect(()=>{let d=new Array;for(const P of $n[o+1])P[12]!=""&&P[12]!=null&&(Ct=new Array,Ct.push(P[12]),d.push(Ct)),++$t;e(d)},[o]),B.useEffect(()=>{let d=[];if(i!=null){for(const P of t)for(const T of i)T.includes(`${P}`)&&d.push(T);s(d),t.length===0?r():c()}},[i,t]),k(H,{children:k("div",{children:k("ul",{children:n?n.map((d,P)=>F("li",{children:[k(hs,{to:`/HowTo/${d[0]}`,target:"_blank",rel:"noopener noreferrer",children:F("button",{type:"button",className:"stepNaviBtn",children:[d[0],". ",d[1]]})})," "]},P)):null})})})}function dr(){const t=B.useRef(),[e,n]=B.useState(!1),{getCollapseProps:s,getToggleProps:i}=er({isExpanded:e}),l=q(r=>r.isVisible);return F(H,{children:[k("button",{type:"button",...i({onClick:()=>n(r=>!r)}),className:e?"expanded":"btn",style:{position:"absolute",top:"20px",left:"20px",visibility:`${l}`},children:e?F(H,{children:[k(_n,{})," How To ",k(ur,{})]}):F(H,{children:[k(_n,{})," How To ",k(fr,{})]})}),k("div",{ref:t,className:"howToBoxContent",...s(),children:k(pr,{})})]})}function hr(){let{visibleObj:t,selectedParts:e,stepSVG:n}=B.useContext(et);const s=q(u=>u.cameraPositionTag),i=q(u=>u.freeControls),l=q(u=>u.wiringStep),r=kn(),[c]=B.useState(()=>new O),[o]=B.useState(()=>new O),f=new O(4,1,8);return ms((u,p)=>{s==="initial"&&l===!1&&(c.lerp(f,.1),o.lerp([0,0,0],.1),u.camera.position.copy(c),u.camera.lookAt(o),i(),r.refresh(t).fit()),s==="initial"&&l===!0&&(console.log(n),n.reset(),i())}),k(H,{})}function wr(){const t=Bt("./OLSK_Vinyl_Cutter_V3_IN.glb"),e=Bt("./OLSK_Vinyl_Cutter_V3_OUT.glb"),n=B.useMemo(()=>t.scene.clone(),[t]),s=B.useMemo(()=>t.scene.clone(),[t]),i=B.useMemo(()=>e.scene.clone(),[e]);B.useState(!1),B.useRef(),B.useRef(),Bt.clear("./OLSK_Vinyl_Cutter_V3_IN.glb"),Bt.clear("./OLSK_Vinyl_Cutter_V3_OUT.glb");const l=q(r=>r.resetCamera);return k(H,{children:F(B.Fragment,{children:[k("aside",{className:"stepNavi",children:k(Vi,{})}),F("section",{id:"currentStepArea",children:[F("nav",{className:"currentStepBar",children:[k("h2",{id:"stepTitleArea",children:k(zi,{})}),F("div",{id:"stepControl",children:[k(bs,{}),"                        "]})]}),F("div",{className:"infoColumn",children:[k("div",{className:"stepPartsArea",children:k(Oi,{})}),k("div",{className:"stepRemarksArea",children:k(Ui,{})})]}),F("article",{className:"viewArea",id:"viewArea",children:[k(B.Suspense,{fallback:null,children:F(ys,{linear:!0,flat:!0,frameloop:"demand",camera:{fov:45,near:1,far:10,position:[4,1,8]},children:[k(mr,{}),k("color",{args:["#f5f5f5"],attach:"background"}),k(gs,{clip:!0,observe:!0,damping:2,margin:.85,children:F(B.Suspense,{fallback:null,children:[k(Li,{modelIn:t,modelOut:e,modelInCopy:n,modelInCopy2:s,modelOutCopy:i}),k(Fi,{})]})}),k(hr,{})]})}),k(ws,{}),F("button",{className:"btn",style:{position:"absolute",bottom:"20px",left:"20px"},onClick:l,children:[k(ar,{})," Reset Camera"]}),k(As,{}),k(dr,{})]})]})]})})}Bt.preload("./OLSK_Vinyl_Cutter_V3_IN.glb");Bt.preload("./OLSK_Vinyl_Cutter_V3_OUT.glb");function mr(){const t=B.useRef();return k(H,{children:k(xs,{ref:t,makeDefault:!0,enableDamping:!1,enableRotate:!0,minAzimuthAngle:1/0,maxAzimuthAngle:1/0,minPolarAngle:0,maxPolarAngle:1/0})})}export{wr as default};
//# sourceMappingURL=App-7827d705.js.map
